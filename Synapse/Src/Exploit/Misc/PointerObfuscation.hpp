#pragma once

#include <cstdint>

namespace syn::PointerObfuscation
{
    enum PtrObfuscationEnum
    {
        ADD = 0x111111,
        SUBLEFT = 0x222222,
        SUBRIGHT = 0x333333,
		XOR = 0x444444,

        //Flag only.
        NONE = 0x555555,
        INV = 0x666666
    };

    typedef void (__fastcall *Obf)(uintptr_t, uintptr_t);
    typedef uintptr_t(__fastcall *DeObf)(uintptr_t);

    inline Obf ObfuscateProto; inline DeObf DeObfuscateProto;
    inline Obf ObfuscateLClosure; inline DeObf DeObfuscateLClosure;
    inline Obf ObfuscateSavedPC; inline DeObf DeObfuscateSavedPC;
    inline Obf ObfuscateGlobalState; inline DeObf DeObfuscateGlobalState;
    inline Obf ObfuscateScriptState; inline DeObf DeObfuscateScriptState;
    inline Obf ObfuscateStringLen; inline DeObf DeObfuscateStringLen;
    inline Obf ObfuscateCClosure; inline DeObf DeObfuscateCClosure;
    inline Obf ObfuscateCKey; inline DeObf DeObfuscateCKey;
    inline Obf ObfuscateFlag; inline DeObf DeObfuscateFlag;

    /* Internal obfuscation */
    inline Obf ObfuscateMemGlobal; inline DeObf DeObfuscateMemGlobal;
    inline Obf ObfuscateMemHash; inline DeObf DeObfuscateMemHash;
    inline Obf ObfuscateMemHasher; inline DeObf DeObfuscateMemHasher;

    void Initialize();
}